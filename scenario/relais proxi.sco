{
  "name": "relais proxi",
  "type": "block",
  "xml": "<block type=\"variables_set\" id=\"183\" inline=\"true\" x=\"321\" y=\"38\"><field name=\"VAR\">seuil</field><value name=\"VALUE\"><block type=\"math_number\" id=\"202\"><field name=\"NUM\">0.15</field></block></value><next><block type=\"procedures_callnoreturn\" id=\"176\"><mutation name=\"ouvre relais\"></mutation></block></next></block><block type=\"procedures_defnoreturn\" id=\"60\" x=\"1062\" y=\"60\"><mutation></mutation><field name=\"NAME\">ouvre relais</field><statement name=\"STACK\"><block type=\"writedigital\" id=\"56\"><field name=\"valeur\">0</field><field name=\"channel\">IO3</field><next><block type=\"variables_set\" id=\"72\" inline=\"true\"><field name=\"VAR\">relais</field><value name=\"VALUE\"><block type=\"math_number\" id=\"101\"><field name=\"NUM\">0</field></block></value></block></next></block></statement></block><block type=\"procedures_defnoreturn\" id=\"102\" x=\"1064\" y=\"173\"><mutation></mutation><field name=\"NAME\">ferme relais</field><statement name=\"STACK\"><block type=\"writedigital\" id=\"103\"><field name=\"valeur\">1</field><field name=\"channel\">IO3</field><next><block type=\"variables_set\" id=\"104\" inline=\"true\"><field name=\"VAR\">relais</field><value name=\"VALUE\"><block type=\"math_number\" id=\"105\"><field name=\"NUM\">1</field></block></value></block></next></block></statement></block><block type=\"onanalog\" id=\"8\" x=\"307\" y=\"311\"><field name=\"channel\">0</field><field name=\"VAR\">v</field><comment pinned=\"false\" h=\"146\" w=\"377\">Exemple : actionne une relais en fonction de la proximité d'une personne\n\nPour faire fonctionner cet exemple :\n- brancher un relais sur IO3\n- brancher un capteur de proximité (type maxbotics EZ) sur AN0\n\n</comment><statement name=\"callback\"><block type=\"controls_if\" id=\"16\" inline=\"false\"><mutation elseif=\"1\"></mutation><value name=\"IF0\"><block type=\"logic_operation\" id=\"113\" inline=\"true\"><field name=\"OP\">AND</field><value name=\"A\"><block type=\"logic_compare\" id=\"32\" inline=\"true\"><field name=\"OP\">LT</field><value name=\"A\"><block type=\"variables_get\" id=\"24\"><field name=\"VAR\">v</field></block></value><value name=\"B\"><block type=\"variables_get\" id=\"211\"><field name=\"VAR\">seuil</field></block></value></block></value><value name=\"B\"><block type=\"logic_compare\" id=\"128\" inline=\"true\"><field name=\"OP\">EQ</field><value name=\"A\"><block type=\"variables_get\" id=\"120\"><field name=\"VAR\">relais</field></block></value><value name=\"B\"><block type=\"math_number\" id=\"147\"><field name=\"NUM\">0</field></block></value></block></value></block></value><statement name=\"DO0\"><block type=\"procedures_callnoreturn\" id=\"153\"><mutation name=\"ferme relais\"></mutation></block></statement><value name=\"IF1\"><block type=\"logic_operation\" id=\"158\" inline=\"true\"><field name=\"OP\">AND</field><value name=\"A\"><block type=\"logic_compare\" id=\"159\" inline=\"true\"><field name=\"OP\">GTE</field><value name=\"A\"><block type=\"variables_get\" id=\"160\"><field name=\"VAR\">v</field></block></value><value name=\"B\"><block type=\"variables_get\" id=\"212\"><field name=\"VAR\">seuil</field></block></value></block></value><value name=\"B\"><block type=\"logic_compare\" id=\"162\" inline=\"true\"><field name=\"OP\">EQ</field><value name=\"A\"><block type=\"variables_get\" id=\"163\"><field name=\"VAR\">relais</field></block></value><value name=\"B\"><block type=\"math_number\" id=\"164\"><field name=\"NUM\">1</field></block></value></block></value></block></value><statement name=\"DO1\"><block type=\"procedures_callnoreturn\" id=\"170\"><mutation name=\"ouvre relais\"></mutation></block></statement></block></statement></block>",
  "codejs": "var seuil;\nvar v;\nvar relais;\n\nfunction ouvre_relais() {\n  writeDigital(\"IO3\",0);relais = 0;\n}\n\nfunction ferme_relais() {\n  writeDigital(\"IO3\",1);relais = 1;\n}\n\n\nseuil = 0.15;\nouvre_relais();\n\n// Exemple : actionne une relais en fonction de la proximité d'une personne\n\n// Pour faire fonctionner cet exemple :\n// - brancher un relais sur IO3\n// - brancher un capteur de proximité (type maxbotics EZ) sur AN0\nonAnalog(0,function(v){\n  if (v < seuil && relais == 0) {\n    ferme_relais();\n  } else if (v >= seuil && relais == 1) {\n    ouvre_relais();\n  }\n});\n",
  "codepy": ""
}